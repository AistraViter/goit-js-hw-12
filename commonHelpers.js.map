{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '44002741-2ff50451c0a1667e01f2d5f97';\nexport const perPage = 15;\naxios.defaults.baseURL = \"https://pixabay.com/api/\";\n\n\nexport async function fetchImages(query, page) {\n  const response = await axios.get(\"/\", {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page: page,\n      per_page: perPage,\n    },\n  });\n  const data = response.data;\n  return data;\n}\n\n\n\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n//Функція створює структуру для галереї зображень\nexport function createImageElements(images) {\n  return images.map(image => {\n    const li = document.createElement('li');\n    li.classList.add('gallery-item');\n    const link = document.createElement('a');\n    link.classList.add('gallery-link');\n    link.href = image.largeImageURL;\n    const img = document.createElement('img');\n    img.classList.add('gallery-image');\n    img.src = image.webformatURL;\n    img.dataset.source = image.largeImageURL;\n    img.alt = image.tags;\n\n    const caption = document.createElement('ul');\n    caption.classList.add('image-caption');\n    const captionItem1 = document.createElement('li');\n    captionItem1.classList.add('caption-item');\n    const captionItemLikes = document.createElement('p');\n    captionItemLikes.textContent = `Likes: \\n${image.likes}`;\n\n    const captionItem2 = document.createElement('li');\n    captionItem2.classList.add('caption-item');\n    const captionItemViewses = document.createElement('p');\n    captionItemViewses.textContent = `Views: \\n${image.views}`;\n\n    const captionItem3 = document.createElement('li');\n    captionItem3.classList.add('caption-item');\n    const captionItemComments = document.createElement('p');\n    captionItemComments.textContent = `Comments: \\n${image.comments}`;\n\n    const captionItem4 = document.createElement('li');\n    captionItem4.classList.add('caption-item');\n    const captionItemDownloads = document.createElement('p');\n    captionItemDownloads.textContent = `Downloads: \\n${image.downloads}`;\n\n    link.append(img);\n    captionItem1.append(captionItemLikes);\n    captionItem2.append(captionItemViewses);\n    captionItem3.append(captionItemComments);\n    captionItem4.append(captionItemDownloads);\n    caption.append(captionItem1, captionItem2, captionItem3, captionItem4);\n    li.append(link);\n    li.append(caption);\n\n    return li;\n  });\n}\n\n//Функція очищує галерею та створює нові елементи згідно раніше створеної структури\nexport function updateGallery(gallery, elements) {\n  gallery.innerHTML = '';\n  gallery.append(...elements);\n}\n\n//Функція для збільшення зображення з бібліотекою SimpleLightbox\nexport function initializeLightbox() {\n  return new SimpleLightbox('.gallery a', {\n    captions: true, // Увімкнути підписи\n    captionSelector: 'img', // Селектор для елемента, з якого брати підпис\n    captionType: 'attr', // Тип отримання підпису: 'attr', 'data' або 'text'\n    captionsData: 'alt', // Атрибут або data-атрибут, який використовується для отримання підпису\n    captionPosition: 'bottom', // Позиція підпису: 'top' або 'bottom'\n    captionDelay: 250, // Затримка перед показом підпису\n  });\n}\n\n\n//Функція для створення повідомлень з бібліотекою iziToast\nexport let backgroundColor = 'red';\nexport function showErrorToast(message, backgroundColor) {\n  iziToast.show({\n    class: 'promise-message',\n    iconUrl: '/goit-js-hw-12/cancel-circle.svg',\n    iconColor: 'whte',\n    message: message,\n    messageColor: 'white',\n    messageSize: '18',\n    backgroundColor: backgroundColor,\n    position: 'topRight',\n    class: 'custom-toast',\n    icon: 'iziToast-icon',\n  });\n}\n","import { perPage, fetchImages } from './js/pixabay-api';\n\nimport {\n  backgroundColor,\n  createImageElements,\n  updateGallery,\n  initializeLightbox,\n  showErrorToast,\n} from './js/render-functions';\n\n//querySelectors\nconst searchForm = document.querySelector('.search-form');\nconst searchField = document.querySelector('#input-search');\nconst gallery = document.querySelector('ul.gallery');\nconst loadMoreBtn = document.querySelector('#btn-load-more');\nconst loadMoreContainer = document.querySelector('.load-more-container');\n\nlet page;\nlet query;\nlet hitsToShow;\n\n// loader is created\nconst loader = document.createElement('div');\nloader.classList.add('loader');\nconst loaderText = document.createElement('p');\nloaderText.classList.add('loader-text');\nloaderText.textContent = 'Loads images, please wait';\nloader.append(loaderText);\n\nfunction showLoaderFirst() {\n  loader.classList.add('loader-below-form');\n  searchForm.append(loader);\n  loader.style.display = 'block';\n}\n\nfunction showLoaderSecond() {\n  loader.classList.add('loader-below-loadMoreBtn');\n  loadMoreContainer.append(loader);\n  loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n  loader.style.display = 'none';\n  loader.classList.remove('loader-below-form');\n  loader.classList.remove('loader-below-loadMoreBtn');\n  loader.remove();\n}\n\n//SEARCH FORM\nsearchForm.addEventListener('submit', event => {\n  event.preventDefault();\n  query = searchField.value.trim();\n\n  if (query !== '') {\n    showLoaderFirst();\n    page = 1;\n    fetchImages(query, page)\n      .then(data => {\n        hitsToShow = data.totalHits;\n        if (hitsToShow >= 1) {\n          const elements = createImageElements(data.hits);\n          updateGallery(gallery, elements);\n          let lightbox = initializeLightbox();\n          lightbox.refresh();\n          const galleryItem = document.querySelector('.gallery-item');\n          if (galleryItem) {\n            const scroll = galleryItem.getBoundingClientRect();\n            const scrollHeight = scroll.height * 2;\n  \n            window.scrollBy({\n              top: scrollHeight,\n              left: 0,\n              behavior: 'smooth',\n            });\n          }\n  \n          console.log(galleryItem.getBoundingClientRect());\n\n          if (hitsToShow - perPage >= 1) {\n            loadMoreBtn.style.display = 'block';\n          } else {\n            showErrorToast(\n              \"We're sorry, but you've reached the end of search results.\",\n              'blue'\n            );\n          }\n        } else {\n          showErrorToast(\n            'Sorry, there are no images matching your search query. Please try again!',\n            'red'\n          );\n        }\n      })\n      .catch(error => {\n        showErrorToast(\n          'An error occurred while fetching the images. Please try again!',\n          'red'\n        );\n        console.log(error);\n      })\n      .finally(() => {\n        // Затримка для тестування\n        setTimeout(() => {\n          hideLoader();\n          searchForm.reset();\n        }, 2000); // Затримка у мілісекундах (тут 2000 мс = 2 сек)\n      });\n  }\n});\n\n//LOAD MORE\nloadMoreBtn.addEventListener('click', event => {\n  event.preventDefault();\n  showLoaderSecond();\n  page++;\n  fetchImages(query, page)\n    .then(data => {\n      hitsToShow = data.totalHits - (page - 1) * perPage;\n      loadMoreBtn.style.display = 'none';\n\n      if (hitsToShow >= 1) {\n        const elements = createImageElements(data.hits);\n        gallery.append(...elements);\n        let lightbox = initializeLightbox();\n        lightbox.refresh();\n        const galleryItem = document.querySelector('.gallery-item');\n        if (galleryItem) {\n          const scroll = galleryItem.getBoundingClientRect();\n          const scrollHeight = scroll.height * 2;\n\n          window.scrollBy({\n            top: 500,\n            left: 0,\n            behavior: 'smooth',\n          });\n        }\n\n        if (hitsToShow - perPage >= 1) {\n          setTimeout(() => {\n            loadMoreBtn.style.display = 'block';\n          }, 2000);\n        } else {\n          showErrorToast(\n            \"We're sorry, but you've reached the end of search results.\",\n            'blue'\n          );\n        }\n      }\n    })\n    .catch(error => {\n      showErrorToast(\n        'An error occurred while fetching the images. Please try again!',\n        'red'\n      );\n      console.log(error);\n    })\n    .finally(() => {\n      // Затримка для тестування\n      setTimeout(() => {\n        hideLoader();\n        searchForm.reset();\n      }, 5000); // Затримка у мілісекундах (тут 2000 мс = 2 сек)\n    });\n});\n"],"names":["API_KEY","perPage","axios","fetchImages","query","page","createImageElements","images","image","li","link","img","caption","captionItem1","captionItemLikes","captionItem2","captionItemViewses","captionItem3","captionItemComments","captionItem4","captionItemDownloads","updateGallery","gallery","elements","initializeLightbox","SimpleLightbox","showErrorToast","message","backgroundColor","iziToast","searchForm","searchField","loadMoreBtn","loadMoreContainer","hitsToShow","loader","loaderText","showLoaderFirst","showLoaderSecond","hideLoader","event","data","galleryItem","scrollHeight","error"],"mappings":"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"}