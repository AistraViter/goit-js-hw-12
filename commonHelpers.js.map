{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '44002741-2ff50451c0a1667e01f2d5f97';\nexport const perPage = 15;\naxios.defaults.baseURL = \"https://pixabay.com/api/\";\n\n\nexport async function fetchImages(query, page) {\n  const {data} = await axios.get(\"/\", {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page: page,\n      per_page: perPage,\n    },\n  });\n  return data;\n}\n\n\n\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n// Функції що стосуються завантаження та видалення loader\n\nexport function showLoader(formWhereShow) {\n  const loader = document.createElement('p');\n  loader.classList.add('loader');\n  loader.textContent = 'Loading images, please wait';\n  loader.style.display = 'block';\n  return formWhereShow.append(loader);\n}\nexport function hideLoader() {\n  const loader = document.querySelector('.loader');\n    loader.style.display = 'none';\n    loader.remove();\n}\n\n//Функція створює структуру для галереї зображень\nexport function createImageElements(images) {\n  return images.map(image => {\n    const li = document.createElement('li');\n    li.classList.add('gallery-item');\n    const link = document.createElement('a');\n    link.classList.add('gallery-link');\n    link.href = image.largeImageURL;\n    const img = document.createElement('img');\n    img.classList.add('gallery-image');\n    img.src = image.webformatURL;\n    img.dataset.source = image.largeImageURL;\n    img.alt = image.tags;\n\n    const caption = document.createElement('ul');\n    caption.classList.add('image-caption');\n    const captionItem1 = document.createElement('li');\n    captionItem1.classList.add('caption-item');\n    const captionItemLikes = document.createElement('p');\n    captionItemLikes.textContent = `Likes: \\n${image.likes}`;\n\n    const captionItem2 = document.createElement('li');\n    captionItem2.classList.add('caption-item');\n    const captionItemViewses = document.createElement('p');\n    captionItemViewses.textContent = `Views: \\n${image.views}`;\n\n    const captionItem3 = document.createElement('li');\n    captionItem3.classList.add('caption-item');\n    const captionItemComments = document.createElement('p');\n    captionItemComments.textContent = `Comments: \\n${image.comments}`;\n\n    const captionItem4 = document.createElement('li');\n    captionItem4.classList.add('caption-item');\n    const captionItemDownloads = document.createElement('p');\n    captionItemDownloads.textContent = `Downloads: \\n${image.downloads}`;\n\n    link.append(img);\n    captionItem1.append(captionItemLikes);\n    captionItem2.append(captionItemViewses);\n    captionItem3.append(captionItemComments);\n    captionItem4.append(captionItemDownloads);\n    caption.append(captionItem1, captionItem2, captionItem3, captionItem4);\n    li.append(link);\n    li.append(caption);\n\n    return li;\n  });\n}\n\n//Функція очищує галерею та створює нові елементи згідно раніше створеної структури\nexport function updateGallery(gallery, elements) {\n  gallery.innerHTML = '';\n  gallery.append(...elements);\n}\n\n//Функція для збільшення зображення з бібліотекою SimpleLightbox\nexport function initializeLightbox() {\n  return new SimpleLightbox('.gallery a', {\n    captions: true, // Увімкнути підписи\n    captionSelector: 'img', // Селектор для елемента, з якого брати підпис\n    captionType: 'attr', // Тип отримання підпису: 'attr', 'data' або 'text'\n    captionsData: 'alt', // Атрибут або data-атрибут, який використовується для отримання підпису\n    captionPosition: 'bottom', // Позиція підпису: 'top' або 'bottom'\n    captionDelay: 250, // Затримка перед показом підпису\n  });\n}\n\n//Функція для створення повідомлень з бібліотекою iziToast\nexport function showErrorToast(message, position, backgroundColor) {\n  iziToast.show({\n    class: 'promise-message',\n    iconUrl: '/goit-js-hw-12/cancel-circle.svg',\n    iconColor: 'whte',\n    message: message,\n    messageColor: 'white',\n    messageSize: '18',\n    backgroundColor: backgroundColor,\n    position: position,\n    class: 'custom-toast',\n    icon: 'iziToast-icon',\n  });\n}\n\n//  Функція для скролу\nexport function scrollByHeight() {\n  const galleryItem = document.querySelector('.gallery-item');\n  if (galleryItem) {\n    const scroll = galleryItem.getBoundingClientRect();\n    const scrollHeight = scroll.height *2;\n    window.scrollBy({\n      top: scrollHeight,\n      left: 0,\n      behavior: 'smooth',\n    });\n  }\n}\n","import { perPage, fetchImages } from './js/pixabay-api';\n\nimport {\n  createImageElements,\n  updateGallery,\n  initializeLightbox,\n  showErrorToast,\n  showLoader,\n  hideLoader,\n  scrollByHeight,\n} from './js/render-functions';\n\n//querySelectors\nconst searchForm = document.querySelector('.search-form');\nconst searchField = document.querySelector('#input-search');\nconst gallery = document.querySelector('ul.gallery');\nconst loadMoreBtn = document.querySelector('#btn-load-more');\nconst loadMoreAfterSearchform = document.querySelector(\n  '.loadmore-after-searchform-container'\n);\nconst loadMoreAfterBtn = document.querySelector(\n  '.loadmore-after-btn-container'\n);\n\nlet page;\nlet query;\nlet hitsToShow;\nlet lightbox = initializeLightbox();\n\n//SEARCH FORM\nsearchForm.addEventListener('submit', async event => {\n  event.preventDefault();\n  query = searchField.value.trim();\n  if (query !== '') {\n    try {\n      showLoader(loadMoreAfterSearchform);\n      const data = await fetchImages(query, (page = 1));\n      hitsToShow = data.totalHits;\n\n      if (hitsToShow >= 1) {\n        const elements = createImageElements(data.hits);\n        updateGallery(gallery, elements);\n        lightbox.refresh();\n        if (hitsToShow - perPage >= 1) {\n          loadMoreBtn.style.display = 'block';\n        } else {\n          loadMoreBtn.style.display = 'none';\n          showErrorToast(\n            \"We're sorry, but you've reached the end of search results.\",\n            'bottomRight',\n            'blue'\n          ); //помилка потестована\n        }\n      } else { \n        loadMoreBtn.style.display = 'none';\n        showErrorToast(\n          'Sorry, there are no images matching your search query. Please try again!',\n          'topRight',\n          'red'\n        );\n        gallery.innerHTML = ''; //помилка потестована\n\n      }\n    } catch (error) {\n      gallery.innerHTML = '';\n      showErrorToast(\n        'An error occurred while fetching the images. Please try again!',\n        'topRight',\n        'red'\n      );\n      console.log(error);\n    } finally {\n      hideLoader();\n      searchForm.reset();\n    }\n  } else { \n    loadMoreBtn.style.display = 'none';\n    showErrorToast('Please enter a search query!', 'topRight', 'red');\n    gallery.innerHTML = '';\n    hideLoader();\n    searchForm.reset(); //помилка потестована\n\n  }\n});\n//LOAD MORE\nloadMoreBtn.addEventListener('click', async event => {\n  event.preventDefault();\n  showLoader(loadMoreAfterBtn);\n  page++;\n  const data = await fetchImages(query, page);\n  try {\n    hitsToShow = data.totalHits - (page - 1) * perPage;\n    if (hitsToShow >= 1) {\n      const elements = createImageElements(data.hits);\n      gallery.append(...elements);\n      lightbox.refresh();\n      scrollByHeight();\n      if (hitsToShow - perPage >= 1) {\n        loadMoreBtn.style.display = 'block';\n      } else {\n        loadMoreBtn.style.display = 'none';\n        showErrorToast(\n          \"We're sorry, but you've reached the end of search results.\",\n          'bottomRight',\n          'blue'\n        ); //помилка потестована\n      }\n    }\n  } catch {\n    showErrorToast(\n      'An error occurred while fetching the images. Please try again!',\n      'topRight',\n      'red'\n    );\n    console.log(error);\n  } finally {\n    hideLoader();\n    searchForm.reset();\n  }\n});\n"],"names":["API_KEY","perPage","axios","fetchImages","query","page","data","showLoader","formWhereShow","loader","hideLoader","createImageElements","images","image","li","link","img","caption","captionItem1","captionItemLikes","captionItem2","captionItemViewses","captionItem3","captionItemComments","captionItem4","captionItemDownloads","updateGallery","gallery","elements","initializeLightbox","SimpleLightbox","showErrorToast","message","position","backgroundColor","iziToast","scrollByHeight","galleryItem","scrollHeight","searchForm","searchField","loadMoreBtn","loadMoreAfterSearchform","loadMoreAfterBtn","hitsToShow","lightbox","event","error"],"mappings":"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"}