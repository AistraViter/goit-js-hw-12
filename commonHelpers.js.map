{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '44002741-2ff50451c0a1667e01f2d5f97';\nexport const perPage = 15;\naxios.defaults.baseURL = \"https://pixabay.com/api/\";\n\n\nexport async function fetchImages(query, page) {\n  const response = await axios.get(\"/\", {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page: page,\n      per_page: perPage,\n    },\n  });\n  const data = response.data;\n  return data;\n}\n\n\n\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n// Функції що стосуються завантаження та видалення loader\n\nexport function showLoader(formWhereShow) {\n  const loader = document.createElement('p');\n  loader.classList.add('loader');\n  loader.textContent = 'Loading images, please wait';\n  loader.style.display = 'block';\n  return formWhereShow.append(loader);\n}\nexport function hideLoader() {\n  const loader = document.querySelector('.loader');\n  return setTimeout(() => {\n    loader.style.display = 'none';\n    loader.remove();\n  }, 2000); // Затримка для тестування\n}\n\n\n//Функція створює структуру для галереї зображень\nexport function createImageElements(images) {\n  return images.map(image => {\n    const li = document.createElement('li');\n    li.classList.add('gallery-item');\n    const link = document.createElement('a');\n    link.classList.add('gallery-link');\n    link.href = image.largeImageURL;\n    const img = document.createElement('img');\n    img.classList.add('gallery-image');\n    img.src = image.webformatURL;\n    img.dataset.source = image.largeImageURL;\n    img.alt = image.tags;\n\n    const caption = document.createElement('ul');\n    caption.classList.add('image-caption');\n    const captionItem1 = document.createElement('li');\n    captionItem1.classList.add('caption-item');\n    const captionItemLikes = document.createElement('p');\n    captionItemLikes.textContent = `Likes: \\n${image.likes}`;\n\n    const captionItem2 = document.createElement('li');\n    captionItem2.classList.add('caption-item');\n    const captionItemViewses = document.createElement('p');\n    captionItemViewses.textContent = `Views: \\n${image.views}`;\n\n    const captionItem3 = document.createElement('li');\n    captionItem3.classList.add('caption-item');\n    const captionItemComments = document.createElement('p');\n    captionItemComments.textContent = `Comments: \\n${image.comments}`;\n\n    const captionItem4 = document.createElement('li');\n    captionItem4.classList.add('caption-item');\n    const captionItemDownloads = document.createElement('p');\n    captionItemDownloads.textContent = `Downloads: \\n${image.downloads}`;\n\n    link.append(img);\n    captionItem1.append(captionItemLikes);\n    captionItem2.append(captionItemViewses);\n    captionItem3.append(captionItemComments);\n    captionItem4.append(captionItemDownloads);\n    caption.append(captionItem1, captionItem2, captionItem3, captionItem4);\n    li.append(link);\n    li.append(caption);\n\n    return li;\n  });\n}\n\n//Функція очищує галерею та створює нові елементи згідно раніше створеної структури\nexport function updateGallery(gallery, elements) {\n  gallery.innerHTML = '';\n  gallery.append(...elements);\n}\n\n//Функція для збільшення зображення з бібліотекою SimpleLightbox\nexport function initializeLightbox() {\n  return new SimpleLightbox('.gallery a', {\n    captions: true, // Увімкнути підписи\n    captionSelector: 'img', // Селектор для елемента, з якого брати підпис\n    captionType: 'attr', // Тип отримання підпису: 'attr', 'data' або 'text'\n    captionsData: 'alt', // Атрибут або data-атрибут, який використовується для отримання підпису\n    captionPosition: 'bottom', // Позиція підпису: 'top' або 'bottom'\n    captionDelay: 250, // Затримка перед показом підпису\n  });\n}\n\n//Функція для створення повідомлень з бібліотекою iziToast\nexport function showErrorToast(message, position, backgroundColor) {\n  iziToast.show({\n    class: 'promise-message',\n    iconUrl: '/goit-js-hw-12/cancel-circle.svg',\n    iconColor: 'whte',\n    message: message,\n    messageColor: 'white',\n    messageSize: '18',\n    backgroundColor: backgroundColor,\n    position: position,\n    class: 'custom-toast',\n    icon: 'iziToast-icon',\n  });\n}\n\n//    position: 'topRight',\n","import { perPage, fetchImages } from './js/pixabay-api';\n\nimport {\n  createImageElements,\n  updateGallery,\n  initializeLightbox,\n  showErrorToast,\n  showLoader,\n  hideLoader,\n} from './js/render-functions';\n\n//querySelectors\nconst searchForm = document.querySelector('.search-form');\nconst searchField = document.querySelector('#input-search');\nconst gallery = document.querySelector('ul.gallery');\nconst loadMoreBtn = document.querySelector('#btn-load-more');\nconst loadMoreAfterSearchform = document.querySelector(\n  '.loadmore-after-searchform-container'\n);\nconst loadMoreAfterBtn = document.querySelector(\n  '.loadmore-after-btn-container'\n);\n\nlet page;\nlet query;\nlet hitsToShow;\n\n//SEARCH FORM\nsearchForm.addEventListener('submit', event => {\n  event.preventDefault();\n  query = searchField.value.trim();\n\n  if (query !== '') {\n    showLoader(loadMoreAfterSearchform);\n    page = 1;\n    fetchImages(query, page)\n      .then(data => {\n        hitsToShow = data.totalHits;\n        if (hitsToShow >= 1) {\n          const elements = createImageElements(data.hits);\n          updateGallery(gallery, elements);\n          let lightbox = initializeLightbox();\n          lightbox.refresh();\n          const galleryItem = document.querySelector('.gallery-item');\n          if (galleryItem) {\n            const scroll = galleryItem.getBoundingClientRect();\n            const scrollHeight = scroll.height * 2;\n\n            window.scrollBy({\n              top: scrollHeight,\n              left: 0,\n              behavior: 'smooth',\n            });\n          }\n\n          console.log(galleryItem.getBoundingClientRect());\n\n          if (hitsToShow - perPage >= 1) {\n            loadMoreBtn.style.display = 'block';\n          } else {\n            showErrorToast(\n              \"We're sorry, but you've reached the end of search results.\",\n              \"bottomRight\",\n              'blue'\n            );\n          }\n        } else {\n          showErrorToast(\n            'Sorry, there are no images matching your search query. Please try again!',\n            \"topRight\",\n            'red'\n          );\n        }\n      })\n      .catch(error => {\n        showErrorToast(\n          'An error occurred while fetching the images. Please try again!',\n          \"topRight\",\n          'red'\n        );\n        console.log(error);\n      })\n      .finally(() => {\n        hideLoader();\n        searchForm.reset();\n      });\n  }\n});\n\n//LOAD MORE\nloadMoreBtn.addEventListener('click', event => {\n  event.preventDefault();\n\n  showLoader(loadMoreAfterBtn);\n  page++;\n  fetchImages(query, page)\n    .then(data => {\n      hitsToShow = data.totalHits - (page - 1) * perPage;\n      loadMoreBtn.style.display = 'none';\n\n      if (hitsToShow >= 1) {\n        const elements = createImageElements(data.hits);\n        gallery.append(...elements);\n        let lightbox = initializeLightbox();\n        lightbox.refresh();\n        const galleryItem = document.querySelector('.gallery-item');\n        if (galleryItem) {\n          const scroll = galleryItem.getBoundingClientRect();\n          const scrollHeight = scroll.height * 2;\n\n          window.scrollBy({\n            top: 500,\n            left: 0,\n            behavior: 'smooth',\n          });\n        }\n\n        if (hitsToShow - perPage >= 1) {\n          setTimeout(() => {\n            loadMoreBtn.style.display = 'block';\n          }, 2000);\n        } else {\n          showErrorToast(\n            \"We're sorry, but you've reached the end of search results.\",\n            \"bottomRight\",\n            'blue'\n          );\n        }\n      }\n    })\n    .catch(error => {\n      showErrorToast(\n        'An error occurred while fetching the images. Please try again!',\n        \"topRight\",\n        'red'\n      );\n      console.log(error);\n    })\n    .finally(() => {\n      hideLoader();\n      searchForm.reset();\n    });\n});\n"],"names":["API_KEY","perPage","axios","fetchImages","query","page","showLoader","formWhereShow","loader","hideLoader","createImageElements","images","image","li","link","img","caption","captionItem1","captionItemLikes","captionItem2","captionItemViewses","captionItem3","captionItemComments","captionItem4","captionItemDownloads","updateGallery","gallery","elements","initializeLightbox","SimpleLightbox","showErrorToast","message","position","backgroundColor","iziToast","searchForm","searchField","loadMoreBtn","loadMoreAfterSearchform","loadMoreAfterBtn","hitsToShow","event","data","galleryItem","scrollHeight","error"],"mappings":"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"}